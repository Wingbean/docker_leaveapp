{% extends "base.html" %}
{% block content %}
<h2 class="text-center mb-4">ตั้งรหัสผ่านใหม่</h2>

<form method="POST"
      action="{{ url_for('reset_password', token=token) }}"   {# [ADD] ชี้ action พร้อม token #}
      class="mx-auto" style="max-width: 400px;" novalidate>  {# [ADD] ใช้ backend เป็นหลัก; browser ยังเช็ค required/minlength #}

  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

  <div class="mb-3">
    <label for="password" class="form-label">รหัสผ่านใหม่</label>
    <input type="password" class="form-control"
           name="password" id="password" required
           autocomplete="new-password" minlength="8" maxlength="128">  {# [ADD] ตามสคีมา/นโยบาย #}
    <div class="form-text">อย่างน้อย 8 ตัวอักษร</div>
  </div>

  <div class="mb-3">
    <label for="password2" class="form-label">ยืนยันรหัสผ่าน</label>
    <input type="password" class="form-control"
           id="password2" required
           autocomplete="new-password" minlength="8" maxlength="128"
           oninput="this.setCustomValidity(this.value !== password.value ? 'รหัสผ่านไม่ตรงกัน' : '');">  {# [ADD] ตรวจให้ตรงกันทันที #}
  </div>

  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" id="showPwd"
           onclick="password.type=this.checked?'text':'password'; password2.type=this.checked?'text':'password'">  {# [ADD] toggle ดู/ซ่อน #}
    <label class="form-check-label" for="showPwd">แสดงรหัสผ่าน</label>
  </div>

  <button type="submit" class="btn btn-success w-100">รีเซ็ตรหัสผ่าน</button>
</form>
{% endblock %}
